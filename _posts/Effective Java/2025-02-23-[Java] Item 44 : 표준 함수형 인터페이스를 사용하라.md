---
title: "[Java] Item 44 : ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ"
categories:
  - Effective Java
tags:
toc: true
toc_sticky: true
date: 2025-02-23 10:32:00 +0900
---

<strong>Effective Javaλ¥Ό μ½κ³  μ •λ¦¬ν• μ •λ¦¬λ³Έμ…λ‹λ‹¤.</strong>
{: .notice}

# π“ Item 44 : ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ

μλ°”κ°€ λλ‹¤λ¥Ό μ§€μ›ν•λ©΄μ„ APIλ¥Ό μ‘μ„±ν•λ” λ¨λ²” μ‚¬λ΅€λ„ ν¬κ² λ°”λ€μ—λ‹¤.

κ³Όκ±° ν…ν”λ¦Ώ λ©”μ„λ“μ ν™μ©μ΄ μ¤„μ–΄λ“¤κ³ , μ΄λ¥Ό λ€μ²΄ν•λ” μ •μ  ν©ν„°λ¦¬λ‚ μƒμ„±μ μ κ³µμ— λ€ν• ν™μ©μ΄ ν¬κ² μ¦κ°€ν•μ€λ‹¤.

μ΄λ• ν•¨μ κ°μ²΄λ¥Ό λ§¤κ°λ³€μλ΅ λ°›λ” μƒμ„±μμ™€ λ©”μ„λ“λ¥Ό λ§λ“¤ λ• ν•¨μν• λ§¤κ°λ³€μ νƒ€μ…μ„ μ¬λ°”λ¥΄κ² μ„ νƒν•΄μ•Ό ν•λ‹¤.

## π«§ μμ‹λ΅ μ•μ•„λ³΄λ” μ¬λ°”λ¥Έ ν•¨μν• λ§¤κ°λ³€μ νƒ€μ…

LinkedHashMapμ„ μƒκ°ν•΄λ³΄μ.

μ΄ ν΄λμ„μ protected λ©”μ„λ“μΈ removeEldestEntryλ¥Ό μ¬μ •μν•λ©΄ μΊμ‹λ΅ μ‚¬μ©ν•  μ μλ‹¤.

λ§µμ— μƒλ΅μ΄ ν‚¤λ¥Ό μ¶”κ°€ν•λ” put λ©”μ„λ“λ” μ΄ λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ trueκ°€ λ°ν™λλ©΄ λ§µμ—μ„ κ°€μ¥ μ¤λλ μ›μ†λ¥Ό μ κ±°ν•λ‹¤.

μμ»¨λ° μ•„λμ™€ κ°™μ΄ μ¬μ •μν•  μ‹ λ§µμ— μ›μ†κ°€ 100κ°κ°€ λ  λ•κΉμ§€ μ»¤μ§€λ‹¤κ°€, κ·Έ μ΄μƒμ΄ λλ©΄ μƒλ΅μ΄ ν‚¤κ°€ λ”ν•΄μ§ λ•λ§λ‹¤ κ°€μ¥ μ¤λλ μ›μ†λ¥Ό ν•λ‚μ”© μ κ±°ν•λ‹¤.

μ¦‰, κ°€μ¥ μµκ·Ό μ›μ† 100κ°λ¥Ό μ μ§€ν•λ” κ²ƒμ΄λ‹¤.

```java
protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
  return size() > 100;
}
```

removeEldstEntry μ„ μ–Έμ„ λ³΄λ©΄ μ΄ ν•¨μ κ°μ²΄λ” Map.Entry<K, V>λ¥Ό λ°›μ•„ booleanμ„ λ°ν™ν•΄μ•Ό ν•  κ²ƒ κ°™μ§€λ§, κΌ­ κ·Έλ ‡μ§€λ” μ•λ‹¤.

removeEldestEntryλ” size()λ¥Ό νΈμ¶ν•΄ λ§µ μ•μ μ›μ† μλ¥Ό μ•μ•„λ‚΄λ”λ°, μ΄λ” removeEldestEntryκ°€ μΈμ¤ν„΄μ¤ λ©”μ„λ“κΈ°μ— κ°€λ¥ν• λ°©μ‹μ΄λ‹¤.

ν•μ§€λ§ μƒμ„±μμ— λ„κΈ°λ” ν•¨μ κ°μ²΄λ” μ΄ λ§µμ μΈμ¤ν„΄μ¤ λ©”μ„λ“κ°€ μ•„λ‹λ‹¤.

ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό νΈμ¶ν•  λ•λ” λ§µμ μΈμ¤ν„΄μ¤κ°€ μ΅΄μ¬ν•μ§€ μ•κΈ° λ•λ¬Έμ΄λ‹¤.

λ”°λΌμ„ λ§µμ€ μκΈ° μμ‹ λ„ ν•¨μ κ°μ²΄μ— κ±΄λ„¤μ¤μ•Ό ν•λ‹¤.

μ΄λ¥Ό λ°μν• ν•¨μν• μΈν„°νμ΄μ¤λ” λ‹¤μκ³Ό κ°™μ΄ μ„ μ–Έ κ°€λ¥ν•λ‹¤.

```java
@FunctionalInterface interface EldestEntryRemovalFunction<K, V> {
  boolean remove(Map<K, V> map, Map.Entry<K, V> eldest);
}
```

## π«§ cf) ν•¨μν• μΈν„°νμ΄μ¤

ν•¨μν• μΈν„°νμ΄μ¤(functional interface)λ” μ¶”μƒλ©”μ„λ“κ°€ 1κ°λ§ μ •μλ μΈν„°νμ΄μ¤λ¥Ό ν†µμΉ­ν•μ—¬ μΌμ»«λ”λ‹¤.

μ΄ μΈν„°νμ΄μ¤ ν•νƒμ λ©μ μ€ μλ°”μ—μ„ λλ‹¤ ν‘ν„μ‹(Lambda Expression)Visit Websiteμ„ μ΄μ©ν•΄ ν•¨μν• ν”„λ΅κ·Έλλ°μ„ κµ¬ν„ν•κΈ° μ„ν•΄μ„μ΄λ‹¤.

## π«§ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤

μ΄λ¬ν• μΈν„°νμ΄μ¤λ„ μ λ™μ‘ν•κΈ°λ” ν•μ§€λ§ κµ³μ΄ μ‚¬μ©ν•  ν•„μ”λ” μ—†λ‹¤.

μλ°” ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬μ— μ΄λ―Έ κ°™μ€ λ¨μ–‘μ μΈν„°νμ΄μ¤κ°€ μ¤€λΉ„λμ–΄ μκΈ° λ•λ¬Έμ΄λ‹¤.

μ΄λ” java.util.function ν¨ν‚¤μ§€λ¥Ό λ³΄λ©΄ λ‹¤μ–‘ν• μ©λ„μ <strong>ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤</strong>κ°€ λ‹΄κ²¨ μλ‹¤.

ν•„μ”ν• μ©λ„μ— λ§λ” κ² μλ‹¤λ©΄, μ§μ ‘ κµ¬ν„ν•μ§€ λ§κ³  ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό ν™μ©ν•λΌ.

κ·Έλ ‡κ² ν•λ‹¤λ©΄ μµνκΈ° μ‰¬μΈ λΏλ”λ¬ μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό λ§μ΄ μ κ³µν•λ―€λ΅ λ‹¤λ¥Έ μ½”λ“μ™€μ μƒνΈμ΄μ©μ„±λ„ ν¬κ² μΆ‹μ•„μ§ κ²ƒμ΄λ‹¤.

### β¨ Predicate μΈν„°νμ΄μ¤

μμ»¨λ° Predicate μΈν„°νμ΄μ¤λ” predicateλ“¤μ„ μ΅°ν•©ν•λ” λ©”μ„λ“λ¥Ό μ κ³µν•λ‹¤.

μ•μ LinkedHashMap μμ—μ„λ” μ§μ ‘ λ§λ“  EldestEntryRemovalFunction λ€μ‹  ν‘μ¤€ μΈν„°νμ΄μ¤μΈ BiPredicate<Map<K, V>, Map.Entry<K, V>>λ¥Ό μ‚¬μ©ν•  μ μλ” κ²ƒμ΄λ‹¤.

## π«§ java.util.function

java.util.function ν¨ν‚¤μ§€μ—λ” μ΄ 43κ°μ μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨ μλ‹¤.

κΈ°λ³Έ μΈν„°νμ΄μ¤ 6κ°λ§ κΈ°μ–µν•λ©΄ λ‚λ¨Έμ§€λ¥Ό μ¶©λ¶„ν μ μ¶”ν•΄λ‚Ό μ μλ‹¤.

μ°Έκ³ λ΅, μ΄ κΈ°λ³Έ μΈν„°νμ΄μ¤λ“¤μ€ λ¨λ‘ μ°Έμ΅° νƒ€μ…μ©μ΄λ‹¤.

### β¨ 1, 2. Operator μΈν„°νμ΄μ¤ (UnaryOperator, BinaryOperator)

: λ°ν™κ°’κ³Ό μΈμμ νƒ€μ…μ΄ κ°™μ€ ν•¨μ

μ‹¤μ λ΅ μ—°μ‚°μ„ ν•  λ• μ“°μ΄λ©°, μΈμκ°€ 1κ°μΈ UnaryOperatorμ™€ 2κ°μΈ BinaryOperatorλ΅ λ‚λ‰λ‹¤.

### β¨ 3. Predicate μΈν„°νμ΄μ¤

: μΈμ ν•λ‚λ¥Ό λ°›μ•„ booleanμ„ λ°ν™ν•λ” ν•¨μ

### β¨ 4. Function μΈν„°νμ΄μ¤

: μΈμμ™€ λ°ν™ νƒ€μ…μ΄ λ‹¤λ¥Έ ν•¨μ

### β¨ 5. Supplier μΈν„°νμ΄μ¤

: μΈμλ¥Ό λ°›μ§€ μ•κ³  κ°’μ„ λ°ν™ (νΉμ€ μ κ³µ)ν•λ” ν•¨μ

### β¨ 6. Consumer μΈν„°νμ΄μ¤

: μΈμλ¥Ό ν•λ‚ λ°›κ³  λ°ν™κ°’μ€ μ—†λ” (νΉν μΈμλ¥Ό μ†λΉ„ν•λ”) ν•¨μ

![image](https://github.com/user-attachments/assets/8cf735b8-ed95-4f26-86f9-ba27d6e07931)

### β¨ κΈ°λ³Έ νƒ€μ…μ λ³€ν•

κΈ°λ³Έ μΈν„°νμ΄μ¤λ” κΈ°λ³Έ νƒ€μ…μΈ int, long, doubleμ©μΌλ΅ κ° 3κ°μ”© λ³€ν•μ΄ μƒκ²¨λ‚λ‹¤.

κ·Έ μ΄λ¦„λ„ κΈ°λ³Έ μΈν„°νμ΄μ¤μ μ΄λ¦„ μ•μ— ν•΄λ‹Ή κΈ°λ³Έ νƒ€μ… μ΄λ¦„μ„ λ¶™μ—¬ μ§€μ—λ‹¤.

μμ»¨λ€ intλ¥Ό λ°›λ” Predicateλ” IntPredicateκ°€ λκ³  longμ„ λ°›μ•„ longμ„ λ°ν™ν•λ” BinaryOperatorμ€ LongBinaryOperatorμ΄ λλ” μ‹μ΄λ‹¤.

μ΄ λ³€ν•λ“¤ μ¤‘ μ μΌν•κ² Function λ³€ν•λ§ λ§¤κ°λ³€μν™”λλ‹¤.

μ •ν™•νλ” λ°ν™ νƒ€μ…λ§ λ§¤κ°λ³€μν™”λμ—λ”λ°, μλ¥Ό λ“¤μ–΄ LongFunction<int[]>μ€ long μΈμλ¥Ό λ°›μ•„ int[]μ„ λ°ν™ν•λ‹¤.

### β¨ Function μΈν„°νμ΄μ¤

Function μΈν„°νμ΄μ¤μ—λ” κΈ°λ³Έ νƒ€μ…μ„ λ°ν™ν•λ” λ³€ν•μ΄ μ΄ 9κ°κ°€ λ” μλ‹¤.

Function μΈν„°νμ΄μ¤λ” μ…λ ¥κ³Ό κ²°κ³Όμ νƒ€μ…μ΄ ν•­μƒ λ‹¤λ¥΄λ‹¤.

μ΄λ• μ…λ ¥κ³Ό κ²°κ³Ό νƒ€μ…μ΄ λ¨λ‘ κΈ°λ³Έ νƒ€μ…μ΄λ©΄ μ ‘λ‘μ–΄λ΅ <strong>SrcToResult</strong>λ¥Ό μ‚¬μ©ν•λ‹¤. (μ΄ 6κ°)

ex) LongToIntFunction : longμ„ λ°›μ•„ intλ¥Ό λ°ν™

λ‚λ¨Έμ§€λ” μ…λ ¥μ΄ κ°μ²΄ μ°Έμ΅°μ΄κ³  κ²°κ³Όκ°€ int, long, doubleμΈ λ³€ν•λ“¤λ΅, μ•μ„μ™€ λ‹¬λ¦¬ μ…λ ¥μ„ λ§¤κ°λ³€μν™”ν•κ³  μ ‘λ‘μ–΄λ΅ <strong>ToResult</strong>λ¥Ό μ‚¬μ©ν•λ‹¤.

ex) ToLongFunction<int[]> : int[]λ¥Ό μΈμλ΅ λ°›μ•„ longμ„ λ°ν™

### β¨ κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤

κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤ μ¤‘ 3κ°λ” μΈμλ¥Ό 2κ°μ”© λ°›λ” λ³€ν•μ΄ μλ‹¤.

- BiPredicate<T, U>
- BiFunction<T, U, R>
- BiConsumer<T, U>

μ΄ μ¤‘μ—μ„λ„ BiFunctionμ—λ” λ‹¤μ‹ κΈ°λ³Έ νƒ€μ…μ„ λ°ν™ν•λ” μ„Έ λ³€ν• ToIntBiFunction<T, U>, ToLongBiFUnction<T, U>, ToDoubleBiFunction<T, U> κ°€ μ΅΄μ¬ν•λ‹¤.

Consumerμ—λ„ κ°μ²΄ μ°Έμ΅°μ™€ κΈ°λ³Έ νƒ€μ… ν•λ‚, μ¦‰ μΈμλ¥Ό 2κ° λ°›λ” λ³€ν•μΈ ObjDoubleConsumer<T>, ObjIntConsumer<T>, ObjLongCOnsumer<T>κ°€ μ΅΄μ¬ν•λ‹¤.

μ΄λ ‡κ² κΈ°λ³Έ μΈν„°νμ΄μ¤μ μΈμ 2κ°μ§λ¦¬ λ³€ν•μ€ 9κ°κ°€ μ΅΄μ¬ν•λ‹¤.

### β¨ BooleanSupplier

BooleanSupplier μΈν„°νμ΄μ¤λ” booleanμ„ λ°ν™ν•λ„λ΅ ν• Supplierμ λ³€ν•μ΄λ‹¤.

μ΄κ²ƒμ΄ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ μ¤‘ booleanμ„ μ΄λ¦„μ— λ…μ‹ν• μ μΌν• μΈν„°νμ΄μ¤μ§€λ§, Predicateμ™€ κ·Έ λ³€ν• 4κ°λ„ boolean κ°’μ„ λ°ν™ν•  μ μλ‹¤.

## π«§ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤μ™€ λ°•μ‹±λ κΈ°λ³Έ νƒ€μ…

μ΄λ ‡λ“― ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ” μ΄ 43κ°κ°€ μ΅΄μ¬ν•λ‹¤.

ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ λ€λ¶€λ¶„μ€ κΈ°λ³Έ νƒ€μ…λ§ μ§€μ›ν•λ‹¤.

κ·Έλ ‡λ‹¤κ³  κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤μ— λ°•μ‹±λ κΈ°λ³Έ νƒ€μ…μ„ λ„£μ–΄ μ‚¬μ©ν•΄μ„λ” μ• λλ‹¤.

κ³„μ‚°λ‰μ΄ λ§μ„ λ•λ” μ„±λ¥μ΄ ν„μ €ν•κ² λ–¨μ–΄μ§€κΈ° λ•λ¬Έμ΄λ‹¤.

## π«§ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤ κµ¬ν„

μ΄μ  λ€λ¶€λ¶„μ μƒν™©μ—μ„λ” μ§μ ‘ μ‘μ„±ν•λ” κ²ƒλ³΄λ‹¤ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” νΈμ΄ λ‚μ•μμ„ μ• κ²ƒμ΄λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μ½”λ“λ¥Ό μ§μ ‘ μ‘μ„±ν•΄μ•Ό ν•  λ•λ” μ–Έμ μΈκ°€?

μ•„λμ™€ κ°™μ€ μƒν™©μ—μ„λ” μ§μ ‘ μ‘μ„±μ΄ ν•„μ”ν•λ‹¤.

1. ν‘μ¤€ μΈν„°νμ΄μ¤ μ¤‘ ν•„μ”ν• μ©λ„μ— λ§λ” κ²ƒμ΄ μ—†μ„ κ²½μ°
2. κµ¬μ΅°μ μΌλ΅ λ‘κ°™μ§€λ§ μ™„μ „ν λ‹¤λ¥Έ λ™μ‘μ„ ν•„μ”λ΅ ν•  λ•

### β¨ Comparator<T>

μ•μ„ λ§ν–λ 2λ²μ²λΌ, κµ¬μ΅°μ μΌλ΅ λ‘κ°™μ€ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤κ°€ μλ”λΌλ„ μ§μ ‘ μ‘μ„±ν•΄μ•Όλ§ ν•  λ•κ°€ μλ‹¤.

κ·Έ λ€ν‘μ μΈ μκ°€ λ°”λ΅ Comparator<T> μΈν„°νμ΄μ¤μ΄λ‹¤.

μ•„λλ” Comparatorμ μ„Έ κ°€μ§€ νΉμ„±μ΄λ‹¤.

μ΄ μ¤‘ ν•λ‚ μ΄μƒμ„ λ§μ΅±ν•λ‹¤λ©΄ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ” κ±΄ μ•„λ‹μ§€ μ§„μ¤‘ν κ³ λ―Όν•΄μ•Ό ν•λ‹¤.

1. μμ£Ό μ“°μ΄λ©° μ΄λ¦„ μμ²΄κ°€ μ©λ„λ¥Ό λ…ν™•ν μ„¤λ…ν•΄μ¤€λ‹¤.
2. λ°λ“μ‹ λ”°λΌμ•Ό ν•λ” κ·μ•½μ΄ μλ‹¤.
3. μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ κ³µν•  μ μλ‹¤.

## π«§ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤ μ‘μ„±

μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‘μ„±ν•κΈ°λ΅ ν–λ‹¤λ©΄, μμ‹ μ΄ μ‘μ„±ν•λ” κ² λ‹¤λ¥Έ κ²ƒλ„ μ•„λ‹ `μΈν„°νμ΄μ¤`μ„μ„ λ…μ‹¬ν•΄μ•Ό ν•λ‹¤.

μΈν„°νμ΄μ¤ μ„¤κ³„ μ‹ λ‹¤μκ³Ό κ°™μ€ κ·μ•½μ„ λ”°λΌ μ„¤κ³„ν•  ν•„μ”κ°€ μλ‹¤.

### β¨ 1. @FunctionalInterface μ• λ„ν…μ΄μ… μ‚¬μ©

μ•μ„ λ³΄μ•λ EldestEntryRemovalFunction μΈν„°νμ΄μ¤μ— @FunctionalInterface μ• λ„ν…μ΄μ…μ΄ λ‹¬λ ¤μλ κ²ƒμ²λΌ μ• λ„ν…μ΄μ…μ„ λ‹¬μ•„μ¤μ•Ό ν•λ‹¤.

1. ν•΄λ‹Ή ν΄λμ¤μ μ½”λ“λ‚ μ„¤λ… λ¬Έμ„λ¥Ό μ½μ„ μ΄μ—κ² κ·Έ μΈν„°νμ΄μ¤κ°€ λλ‹¤μ©μΌλ΅ μ„¤κ³„λ κ²ƒμ„μ„ μ•λ ¤μ¤€λ‹¤.
2. ν•΄λ‹Ή μΈν„°νμ΄μ¤κ°€ μ¶”μƒ λ©”μ„λ“λ¥Ό μ¤μ§ ν•λ‚λ§ κ°€μ§€κ³  μμ–΄μ•Ό μ»΄νμΌλκ² ν•΄μ¤€λ‹¤.
3. κ·Έ κ²°κ³Ό μ μ§€λ³΄μ κ³Όμ •μ—μ„ λ„κµ°κ°€ μ‹¤μλ΅ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•μ§€ λ»ν•κ² λ§‰μ•„μ¤€λ‹¤.

### β¨ 2. μ„λ΅ λ‹¤λ¥Έ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κ°™μ€ μ„μΉμ μΈμλ΅ λ°›λ” λ©”μ„λ“λ“¤μ„ λ‹¤μ¤‘ μ •μν•΄μ„λ” μ• λλ‹¤.

ν΄λΌμ΄μ–ΈνΈμ—κ² λ¶ν•„μ”ν• λ¨νΈν•¨λ§ μ•κ²¨μ¤„ λΏμ΄λ©°, μ΄ λ¨νΈν•¨μΌλ΅ μΈν•΄ μ‹¤μ  λ¬Έμ κ°€ λ°μƒν•κΈ°λ„ ν•λ‹¤.

κ·Έλμ„ μ¬λ°”λ¥Έ λ©”μ„λ“λ¥Ό μ•λ ¤μ£ΌκΈ° μ„ν•΄ ν•λ³€ν™ν•΄μ•Ό ν•  κ°€λ¥μ„±λ„ μƒκΈ΄λ‹¤.

## π«§ μ°Έκ³  μλ£
- [ν•¨μν• μΈν„°νμ΄μ¤ ν‘μ¤€ API μ΄μ •λ¦¬ | Tistory | Inpa Dev](https://inpa.tistory.com/entry/%E2%98%95-%ED%95%A8%EC%88%98%ED%98%95-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-API)

- [[Java] ν•¨μν• μΈν„°νμ΄μ¤μ™€ λλ‹¤ | Tistory | μΆ‹μ€ κ²½ν— ν›”μ³λ¨ΉκΈ°](https://xxeol.tistory.com/20)